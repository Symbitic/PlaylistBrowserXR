<html>
<head>
<script>
function load() {
  const url = new URL(window.location.href);

  let data = {};

  if (url.searchParams.has('error')) {
    data = {
      'type': 'error',
      'data': url.searchParams.get('error')
    };
  } else if (!url.searchParams.has('code')) {
    data = {
      'type': 'error',
      'data': 'missing_code'
    };
  } else {
    data = {
      'type': 'success',
      'data': url.searchParams.get('code')
    };
  }

  window.opener.postMessage(JSON.stringify(data), '*');
}

// https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onload
// https://developer.mozilla.org/en-US/docs/Web/API/Document/DOMContentLoaded_event
// document.addEventListener('DOMContentLoaded', () => {});
window.onload = load;
</script>
</head>
</html>
